# README

## Project Overview

This application is designed to upload an Excel file and send a SOAP XML request the Customs Office System for reporting purposes. It reads data from the Excel file, formats it into XML, and sends the resulting XML via a SOAP request using Axios.

## Table of Contents

- [Installation](#installation)
- [Usage](#usage)
- [Dependencies](#dependencies)
- [SOAP Request Mechanism](#soap-request-mechanism)
- [Class Descriptions](#class-descriptions)

## Installation

To get started with the application, clone the repository and install the required dependencies.

```bash
git clone
cd
npm install
```

Ensure that you have Node.js and npm (Node Package Manager) installed.

## Usage

1. **Instantiate the Converter class with an Excel file.**
2. **Invoke the `convert` method to process the file.** Provide a callback function to handle the XML result.

```javascript
import Converter from './path/to/converter';

const file = //... your Excel file input;
const converter = new Converter(file);

converter.convert((xmlData) => {
  console.log(xmlData);  // Handle XML data here, e.g., send it via SOAP request
});
```

## Dependencies

- axios: For making HTTP requests.
- xlsx: For reading Excel files and converting them to JSON.
- xmlbuilder2: For generating XML based on structured data.

## SOAP Request Mechanism

The SOAP request is structured as follows:

1. **Service Name**: The name of the service to be invoked is specified in the `SERVICE_NAME` constant.
2. **Endpoint**: The URL to which the SOAP request will be sent is defined in `ENDPOINT`.
3. **Credentials**: Username and password for authentication are retrieved from environment variables.

### SOAP Envelope Structure

The SOAP XML envelope is constructed in the `soapRequest` function. The required structure will resemble the following template:

```xml
      XML_DATA
      USERNAME
      PASSWORD
```

The SOAP envelope generated by the application will look like this:

```xml
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance"
               xmlns:xsd="https://www.w3.org/2001/XMLSchema"
               xmlns:soap="https://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <YourServiceName xmlns="http://services.beacukai.go.id/">
      <fStream>Generated XML Data</fStream>
      <Username>YourUsername</Username>
      <Password>YourPassword</Password>
    </YourServiceName>
  </soap:Body>
</soap:Envelope>
```

### Sending the Request

The constructed XML envelope is sent with the following configuration:

- **Method**: POST
- **Content-Type**: text/xml; charset=utf-8
- **Accept**: text/xml, application/xml
- **SOAPAction**: The specific action for the service.

## Class Descriptions

### Converter

The `Converter` class reads an Excel file, formats the data, and converts it to XML.

- **Constructor**: `constructor(file)`
  - **Parameters**:
    - `file` - The Excel file to be converted.
- **Method**: `convert(callback)`
  - **Parameters**:
    - `callback` - A function to execute once the conversion to XML is complete, receiving the XML data as an argument.

### ExcelReader

The `ExcelReader` class reads Excel files and converts the first worksheet into JSON format.

- **Constructor**: `constructor(file)`
  - **Parameters**:
    - `file` - The Excel file to read.
- **Method**: `read(callback)`
  - **Parameters**:
    - `callback` - A function that is called with the JSON data after reading the file.

### ObjectFormatter

The `ObjectFormatter` class reformats the JSON data into an object with headers as keys and column values as arrays.

- **Method**: `static format(jsonData)`
  - **Parameters**:
    - `jsonData` - An array of arrays where the first array contains headers.
  - **Returns**: An object with headers as keys.

### XMLFormatter

The `XMLFormatter` class generates XML based on the provided data.

- **Constructor**: `constructor(data)`

  - **Parameters**:
    - `data` - Object containing the data to be formatted into XML.

- **Method**: `headerFormatter()`

  - Responsible for formatting the header section of the XML.

- **Method**: `contentFormatter()`

  - Responsible for generating the content section of the XML.

- **Method**: `getFormattedXML()`
  - **Returns**: The final XML string.

### Static Properties

- **HEADER_DATA**: An array that defines the headers to be included in the XML.

This document offers a comprehensive overview of the project, including how to install, use it, and a detailed description of the key classes and their functionalities for development and maintenance.
